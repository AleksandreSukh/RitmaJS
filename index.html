<!DOCTYPE html>
<html>

<head>
    <!-- <script src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-2.2.1.js"></script> -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script type="text/javascript">
        function GetResults(word) {
            var self = this;
            self.tasksURI = "https://ec2-54-84-34-85.compute-1.amazonaws.com/api/ritma/" + word;
            self.freetoken = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1bmlxdWVfbmFtZSI6InRlc3QiLCJzdWIiOiJ0ZXN0Iiwicm9sZSI6IlVzZXJzIiwiaXNzIjoiaHR0cDovL2xvY2FsaG9zdC8iLCJhdWQiOiJBbnkiLCJleHAiOjE1MjcyMjUxMTgsIm5iZiI6MTUxMTY3MzExOH0.GwGR65c8qQK7zrnF6LWTjtEIgxfs-uQ_dPhCkf9J7LU";
            self.ajax = function (uri, method, data) {
                var request = {
                    url: uri,
                    type: method,
                    contentType: "application/json",
                    accepts: "application/json",
                    cache: false,
                    dataType: 'json',
                    data: JSON.stringify(data),
                    beforeSend: function (xhr) {
                        xhr.setRequestHeader("Authorization",
                            "Bearer " + self.freetoken);
                    },
                    error: function (jqXHR) {
                        console.log("ajax error " + jqXHR.status);
                    }
                };
                return $.ajax(request);
            }

            self.ajax(self.tasksURI, 'GET').done(function (data) {
                //console.log(data);
                var listDiv = document.getElementById('list-puntate');
                $(listDiv).empty();
                var ul = document.createElement('ul');
                for (var i = 0; i < data.length; ++i) {
                    var li = document.createElement('li');
                    li.innerHTML = data[i];   // Use innerHTML to set the text
                    ul.appendChild(li);
                }
                listDiv.appendChild(ul);
            });
        }




    </script>
</head>

<body>
    <input type="text" id="word-input"></input>
    <button id="get-results">გლიჯე Enter-ს</button>
    <script type="text/javascript">
    $(document).ready(function () {
            $("#list-puntate").hide();
            $("#loading").hide();
        });
        $(document).ajaxStart(function () {
            $("#list-puntate").hide();
            $("#loading").show();
        });

        $(document).ajaxStop(function () {
            $("#loading").hide();
            $("#list-puntate").show();
        });

        $("#get-results").click(
            function (event) {
                GetResults($("#word-input").val())
            });
        $("#word-input").keyup(function (event) {
            if (event.keyCode === 13) {
                $("#get-results").click();
            }
        });
    </script>
    <div id="loading" ><img src="zviadi.jpg"/></div>
    <div class="col-lg-12" id="list-puntate">
        <ul>
            <!-- <li>...</li> -->
        </ul>
    </div>
</body>

</html>